<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/26.0.1 Safari/605.1.15" version="29.3.4">
  <diagram id="FaithMotivatorChatbot" name="Architecture">
    <mxGraphModel dx="1627" dy="1108" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="Route 53 (chatbot.muykol.com)" vertex="1">
          <mxGeometry height="70" width="170" x="40" y="40" as="geometry" />
        </mxCell>
        <mxCell id="3" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="CloudFront (+ WAF optional) Path routing: / → S3, /api/* → ALB" vertex="1">
          <mxGeometry height="90" width="260" x="260" y="30" as="geometry" />
        </mxCell>
        <mxCell id="4" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="S3 Bucket Reflex static export (OAC/OAI, Block Public)" vertex="1">
          <mxGeometry height="80" width="200" x="220" y="160" as="geometry" />
        </mxCell>
        <mxCell id="5" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="ALB (HTTPS) Origin for /api/* Public Subnets" vertex="1">
          <mxGeometry height="80" width="200" x="480" y="160" as="geometry" />
        </mxCell>
        <mxCell id="6" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f8f8;strokeColor=#999999;strokeWidth=1;dashed=1;" value="VPC (2+ AZ)" vertex="1">
          <mxGeometry height="420" width="980" x="120" y="280" as="geometry" />
        </mxCell>
        <mxCell id="7" parent="6" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f8f8;strokeColor=#999999;strokeWidth=1;dashed=1;" value="Public Subnets" vertex="1">
          <mxGeometry height="160" width="430" x="150" y="330" as="geometry" />
        </mxCell>
        <mxCell id="8" parent="6" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f8f8;strokeColor=#999999;strokeWidth=1;dashed=1;" value="Private Subnets (no NAT) Egress only via VPC Endpoints" vertex="1">
          <mxGeometry height="160" width="430" x="150" y="520" as="geometry" />
        </mxCell>
        <mxCell id="9" parent="6" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="ECS Fargate Service FastAPI/Reflex backend /api/chat /api/auth/callback" vertex="1">
          <mxGeometry height="110" width="350" x="190" y="560" as="geometry" />
        </mxCell>
        <mxCell id="10" parent="6" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="VPC Endpoints (PrivateLink) Interface: Bedrock, Cognito, SES*, ECR, CW Logs, Secrets, STS... Gateway: S3, DynamoDB (*SES optional if email via worker)" vertex="1">
          <mxGeometry height="220" width="430" x="620" y="360" as="geometry" />
        </mxCell>
        <mxCell id="11" parent="6" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" value="No NAT Gateway No public IPs on tasks" vertex="1">
          <mxGeometry height="60" width="220" x="620" y="600" as="geometry" />
        </mxCell>
        <mxCell id="12" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="Cognito Hosted UI (User Pool)" vertex="1">
          <mxGeometry height="70" width="180" x="1140" y="60" as="geometry" />
        </mxCell>
        <mxCell id="13" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="Amazon Bedrock LLM + Guardrails" vertex="1">
          <mxGeometry height="70" width="180" x="1140" y="150" as="geometry" />
        </mxCell>
        <mxCell id="14" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="DynamoDB Users/Profiles Sessions/Consent Prayer tickets" vertex="1">
          <mxGeometry height="90" width="180" x="1140" y="260" as="geometry" />
        </mxCell>
        <mxCell id="15" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="SQS (or EventBridge) PrayerConnectRequested" vertex="1">
          <mxGeometry height="70" width="180" x="1140" y="380" as="geometry" />
        </mxCell>
        <mxCell id="16" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="Worker Lambda (public egress) Post to Telegram Send email via SES" vertex="1">
          <mxGeometry height="90" width="180" x="1140" y="480" as="geometry" />
        </mxCell>
        <mxCell id="17" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="Amazon SES Email confirmation &amp; volunteer meet-link flow" vertex="1">
          <mxGeometry height="90" width="180" x="1140" y="610" as="geometry" />
        </mxCell>
        <mxCell id="18" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#4d4d4d;strokeWidth=1;" value="Telegram Group Prayer Team" vertex="1">
          <mxGeometry height="80" width="200" x="1340" y="520" as="geometry" />
        </mxCell>
        <mxCell id="19" edge="1" parent="1" source="2" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="20" edge="1" parent="1" source="3" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="4" value="/ (static)">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="21" edge="1" parent="1" source="3" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="5" value="/api/*">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="22" edge="1" parent="1" source="5" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="9" value="Forward to target group">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="23" edge="1" parent="1" source="3" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="12" value="Redirect (login)">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="24" edge="1" parent="1" source="12" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="5" value="Auth code → /api/auth/callback">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="25" edge="1" parent="1" source="9" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="10" value="AWS API calls (via endpoints)">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="26" edge="1" parent="1" source="10" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="13" value="InvokeModel">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="27" edge="1" parent="1" source="10" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="14" value="Read/Write">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="28" edge="1" parent="1" source="9" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="15" value="Publish event PrayerConnectRequested">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="29" edge="1" parent="1" source="15" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="16" value="Trigger">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="30" edge="1" parent="1" source="16" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="18" value="Send message (email + request id)">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="31" edge="1" parent="1" source="16" style="endArrow=block;html=1;rounded=0;strokeWidth=2;" target="17" value="Send email">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
